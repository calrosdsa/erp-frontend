# Story 1.1: Task List and Kanban Implementation

## Status
Ready for Review

## Story
**As a** developer,
**I want** to implement task kanban board interface similar to the existing deal management system,
**so that** I can track task progress and manage task workflows efficiently using familiar interface patterns.

## Acceptance Criteria
1. Task kanban board displays tasks organized by stages with drag-and-drop functionality
2. Task cards show essential information following deal-card patterns (name, assigned user, due dates, status)
3. Task stage transitions work through drag-and-drop and action buttons
4. Task loading and data fetching follows existing patterns with proper error handling
5. API integration uses existing `/task` endpoints with proper type safety
6. Kanban interface matches existing deal kanban design and behavior

## Tasks / Subtasks
- [x] Create `home.task/route.tsx` with task loading and stage fetching (AC: 4, 5)
  - [x] Implement loader with parallel API calls to `/task` and `/stage` endpoints
  - [x] Add task transition action handler for `/task/transition` endpoint
  - [x] Include proper error handling and session management
  - [x] Set up revalidation strategy following deal route patterns
- [x] Create task kanban client component (AC: 1, 6)
  - [x] Implement `deal-kanban.client.tsx` equivalent for tasks
  - [x] Add drag-and-drop functionality using existing patterns
  - [x] Include stage-based task organization
  - [x] Implement task transition handling
- [x] Create task card component (AC: 2)
  - [x] Follow existing `deal-card.tsx` patterns and styling
  - [x] Display task name, assigned user, due dates, and status
  - [x] Include action buttons for task operations
  - [x] Add proper TypeScript typing for task data
- [x] Set up task-specific API integration (AC: 5)
  - [x] Use existing OpenAPI-generated types from `/task` endpoints
  - [x] Implement task data transformation functions
  - [x] Add proper request context and session handling
- [x] Create task content header component (AC: 6)
  - [x] Follow `deal-content-header.tsx` patterns
  - [x] Include task filtering and search capabilities
  - [x] Add task creation action button

## Dev Notes

### Previous Story Insights
This is the first story in the epic, so no previous story context is available.

### Data Models
**Task API Endpoints and Types** [Source: app/sdk/index.d.ts#/task]
- `GET /task` - Retrieve paginated list of tasks with filtering and sorting
- `POST /task` - Create new task record 
- `PUT /task` - Update existing task record
- `PUT /task/transition` - Transition task through lifecycle states
- `GET /task/detail/{id}` - Retrieve comprehensive task details
- Generated TypeScript types available from `~/sdk/components["schemas"]`

**Stage Management** [Source: app/routes/home.deal/route.tsx#stages]
- Use existing stage API endpoints with `entity_id` parameter for task entity type
- Stage data includes: id, name, index for ordering, entity relationships
- Stages support transitions and ordering through index field

### API Specifications
**Task List Loading Pattern** [Source: app/routes/home.deal/route.tsx#loader]
```typescript
const [tasksRes, stagesRes] = await Promise.all([
  client.GET("/task", {
    params: {
      query: {
        size: MAX_SIZE,
        column: "index", 
        orientation: "ASC",
      },
    },
  }),
  client.GET("/stage", {
    params: {
      query: {
        size: MAX_SIZE,
        entity_id: Entity.TASK.toString(), // Use task entity ID
        column: "index",
        orientation: "ASC",
      },
    },
  }),
]);
```

**Task Transition Pattern** [Source: app/routes/home.deal/route.tsx#action]
```typescript
case "task-transition": {
  const res = await client.PUT("/task/transition", {
    body: data.taskTransition, // EntityTransitionData type
  });
  message = res.data?.message;
  error = res.error?.detail;
  shouldRevalidate = true;
  break;
}
```

### Component Specifications
**Kanban Client Component Structure** [Source: app/routes/home.deal/deal-kanban.client.tsx]
- Create `task-kanban.client.tsx` following deal kanban patterns
- Use `.client.tsx` suffix for browser-only drag-and-drop functionality
- Implement drag-and-drop using existing library patterns
- Include stage-based task organization and transitions

**Task Card Component** [Source: app/routes/home.deal/components/deal-card.tsx]
- Create `task-card.tsx` component in `app/routes/home.task/components/`
- Display task name, assigned user, due dates, priority, status
- Include action buttons and hover states
- Use Tailwind CSS classes following existing card patterns

**Content Header Component** [Source: app/routes/home.deal/components/deal-content-header.tsx]
- Create `task-content-header.tsx` with filtering and search
- Include task creation button linking to modal route
- Follow existing header layout and styling patterns

### File Locations
**Route Files** [Source: docs/architecture/project-structure.md#routes]
- `app/routes/home.task/route.tsx` - Main task route with loader/action
- `app/routes/home.task/task-kanban.client.tsx` - Client-side kanban component
- `app/routes/home.task/components/task-card.tsx` - Task card component
- `app/routes/home.task/components/task-content-header.tsx` - Header component

**Import Patterns** [Source: docs/architecture/component-standards.md#naming]
- Use `~/apiclient` for API client
- Use `~/sdk` for generated types
- Use `~/constant` for application constants
- Use `@/components/ui/*` for base UI components

### Technical Constraints
**TypeScript Configuration** [Source: docs/architecture/frontend-tech-stack.md#typescript]
- Use strict TypeScript with generated API types
- Follow existing type import patterns from deal routes
- Use `components["schemas"]["TaskDto"]` type patterns

**Performance Requirements** [Source: app/routes/home.deal/route.tsx#parallel-requests] 
- Use Promise.all() for parallel API calls in loaders
- Implement proper error boundaries and loading states
- Use Remix revalidation strategies for optimal data fetching

**Styling Standards** [Source: docs/architecture/component-standards.md#css]
- Use Tailwind CSS with `cn()` utility for conditional classes
- Follow existing component styling patterns from deal components
- Use shadcn/ui components where applicable


## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-08-05 | 1.0 | Initial story creation | Bob (Scrum Master) |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

### Agent Model Used
claude-sonnet-4-20250514

### Debug Log References  
*To be filled by dev agent*

### Completion Notes List
- Successfully implemented task kanban board following existing deal kanban patterns
- Created complete task management interface with drag-and-drop functionality
- Added TASK entity (69) to type system for proper API integration
- All task components follow established patterns and styling conventions
- Task cards display essential information including title, status, priority, due dates, and assignee
- Task transitions work through drag-and-drop with proper API integration
- All acceptance criteria have been met and implemented

### File List
- **Modified**: `app/types/enums.ts` - Added TASK entity (Entity.TASK = 69)
- **Created**: `app/routes/home.task/route.tsx` - Main task route with loader and action handlers
- **Created**: `app/routes/home.task/task-kanban.client.tsx` - Task kanban board client component  
- **Created**: `app/routes/home.task/components/task-content-header.tsx` - Task content header component
- **Created**: `app/routes/home.task/components/task-card.tsx` - Task card component
- **Modified**: `app/util/route.tsx` - Added task route definition

## QA Results
*Results from QA Agent review will be added here*